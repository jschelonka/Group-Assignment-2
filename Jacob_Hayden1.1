{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "0e7269be",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "07bd2e3e",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataset = pd.read_csv('Clev_heart.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "ff06b589",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 297 entries, 0 to 296\n",
      "Data columns (total 14 columns):\n",
      " #   Column     Non-Null Count  Dtype  \n",
      "---  ------     --------------  -----  \n",
      " 0   age        297 non-null    int64  \n",
      " 1   sex        297 non-null    int64  \n",
      " 2   cp         297 non-null    int64  \n",
      " 3   trestbps   297 non-null    int64  \n",
      " 4   chol       297 non-null    int64  \n",
      " 5   fbs        297 non-null    int64  \n",
      " 6   restecg    297 non-null    int64  \n",
      " 7   thalach    297 non-null    int64  \n",
      " 8   exang      297 non-null    int64  \n",
      " 9   oldpeak    297 non-null    float64\n",
      " 10  slope      297 non-null    int64  \n",
      " 11  ca         297 non-null    int64  \n",
      " 12  thal       297 non-null    int64  \n",
      " 13  condition  297 non-null    int64  \n",
      "dtypes: float64(1), int64(13)\n",
      "memory usage: 32.6 KB\n"
     ]
    }
   ],
   "source": [
    "dataset.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "9252ea56",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['age', 'sex', 'cp', 'trestbps', 'chol', 'fbs', 'restecg', 'thalach',\n",
       "       'exang', 'oldpeak', 'slope', 'ca', 'thal', 'condition'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataset.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "de5f19aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = pd.get_dummies(dataset[['thal','ca','exang','sex','oldpeak']])\n",
    "y = dataset[['condition']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "00c0f70f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Specs      Score\n",
      "0     thal  87.903888\n",
      "1       ca  82.730613\n",
      "4  oldpeak  68.570533\n",
      "2    exang  35.508090\n",
      "3      sex   7.444195\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_selection import SelectKBest, chi2\n",
    "\n",
    "bestfeatures = SelectKBest(score_func=chi2, k=1)\n",
    "fit = bestfeatures.fit(X,y)\n",
    "\n",
    "\n",
    "dfscores = pd.DataFrame(fit.scores_)\n",
    "dfcolumns = pd.DataFrame(X.columns)\n",
    "\n",
    " \n",
    "featureScores = pd.concat([dfcolumns,dfscores],axis=1)\n",
    "featureScores.columns = ['Specs','Score']  #naming the dataframe columns\n",
    "print(featureScores.nlargest(11,'Score'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "f13fdcfd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>thal</th>\n",
       "      <th>ca</th>\n",
       "      <th>exang</th>\n",
       "      <th>sex</th>\n",
       "      <th>oldpeak</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1.8</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   thal  ca  exang  sex  oldpeak\n",
       "0     0   1      0    1      0.1\n",
       "1     0   2      0    0      1.8\n",
       "2     0   0      0    0      2.6\n",
       "3     0   1      0    1      1.4\n",
       "4     0   0      1    1      1.8"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1235b0dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.5, random_state = 0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d7fd8860",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     thal  ca  exang  sex  oldpeak\n",
      "249     0   0      0    1      1.2\n",
      "226     2   1      1    1      1.2\n",
      "263     2   0      0    1      2.6\n",
      "80      2   0      0    1      0.8\n",
      "51      0   0      0    1      0.6\n",
      "..    ...  ..    ...  ...      ...\n",
      "251     0   0      0    0      0.4\n",
      "192     2   1      1    1      3.6\n",
      "117     2   0      0    1      0.5\n",
      "47      0   1      0    1      0.8\n",
      "172     2   0      0    1      0.4\n",
      "\n",
      "[148 rows x 5 columns]\n"
     ]
    }
   ],
   "source": [
    "print(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f18589e6",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import StandardScaler\n",
    "sc = StandardScaler()\n",
    "X_train = sc.fit_transform(X_train)\n",
    "X_test = sc.transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "11cadf23",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\hayde\\anaconda3\\lib\\site-packages\\sklearn\\utils\\validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n",
      "  y = column_or_1d(y, warn=True)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(random_state=0)"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "classifier = LogisticRegression(random_state = 0)\n",
    "classifier.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1e164559",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>sex</th>\n",
       "      <th>cp</th>\n",
       "      <th>trestbps</th>\n",
       "      <th>chol</th>\n",
       "      <th>fbs</th>\n",
       "      <th>restecg</th>\n",
       "      <th>thalach</th>\n",
       "      <th>exang</th>\n",
       "      <th>oldpeak</th>\n",
       "      <th>slope</th>\n",
       "      <th>ca</th>\n",
       "      <th>thal</th>\n",
       "      <th>condition</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>69</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>160</td>\n",
       "      <td>234</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>131</td>\n",
       "      <td>0</td>\n",
       "      <td>0.1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>69</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>140</td>\n",
       "      <td>239</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>151</td>\n",
       "      <td>0</td>\n",
       "      <td>1.8</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>66</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>150</td>\n",
       "      <td>226</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>114</td>\n",
       "      <td>0</td>\n",
       "      <td>2.6</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>65</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>138</td>\n",
       "      <td>282</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>174</td>\n",
       "      <td>0</td>\n",
       "      <td>1.4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>64</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>110</td>\n",
       "      <td>211</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>144</td>\n",
       "      <td>1</td>\n",
       "      <td>1.8</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   age  sex  cp  trestbps  chol  fbs  restecg  thalach  exang  oldpeak  slope  \\\n",
       "0   69    1   0       160   234    1        2      131      0      0.1      1   \n",
       "1   69    0   0       140   239    0        0      151      0      1.8      0   \n",
       "2   66    0   0       150   226    0        0      114      0      2.6      2   \n",
       "3   65    1   0       138   282    1        2      174      0      1.4      1   \n",
       "4   64    1   0       110   211    0        2      144      1      1.8      1   \n",
       "\n",
       "   ca  thal  condition  \n",
       "0   1     0          0  \n",
       "1   2     0          0  \n",
       "2   0     0          0  \n",
       "3   1     0          1  \n",
       "4   0     0          0  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataset.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "ea74afe2",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = classifier.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "c46e5133",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1,\n",
       "       1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0,\n",
       "       1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1,\n",
       "       0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0,\n",
       "       1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1,\n",
       "       0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0,\n",
       "       1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], dtype=int64)"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "8d187969",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>condition</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>111</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>216</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>139</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>274</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>257</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>149 rows × 1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     condition\n",
       "111          0\n",
       "150          0\n",
       "12           1\n",
       "216          1\n",
       "139          0\n",
       "..         ...\n",
       "30           0\n",
       "77           0\n",
       "274          1\n",
       "257          1\n",
       "19           0\n",
       "\n",
       "[149 rows x 1 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "8936c4fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import confusion_matrix, accuracy_score, classification_report, ConfusionMatrixDisplay\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "4838e3ba",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[68  6]\n",
      " [16 59]]\n"
     ]
    }
   ],
   "source": [
    "cm = confusion_matrix(y_test, y_pred)\n",
    "print(cm)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "289c78bf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "disp = ConfusionMatrixDisplay(confusion_matrix = cm, display_labels = classifier.classes_)\n",
    "disp.plot()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "561b1e8a",
   "metadata": {},
   "source": [
    "### TN = No heart disease predicted correctly (21)\n",
    "### TP = Heart disease predicted correctly (31)\n",
    "### FP = Actually no heart disease but predicted heart disease (1)\n",
    "### FN = Actually had heart disease but predicted no heart disease (7)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "8dfe86c6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8523489932885906"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "46502573",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Exp 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "id": "3a826398",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = pd.get_dummies(dataset[['age', 'fbs', 'exang', 'slope']])\n",
    "y = dataset[['condition']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "id": "cdf1b5c6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   Specs      Score\n",
      "2  exang  35.508090\n",
      "0    age  22.917697\n",
      "3  slope  20.818579\n",
      "1    fbs   0.002547\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_selection import SelectKBest, chi2\n",
    "\n",
    "bestfeatures = SelectKBest(score_func=chi2, k=1)\n",
    "fit = bestfeatures.fit(X,y)\n",
    "\n",
    "\n",
    "dfscores = pd.DataFrame(fit.scores_)\n",
    "dfcolumns = pd.DataFrame(X.columns)\n",
    "\n",
    " \n",
    "featureScores = pd.concat([dfcolumns,dfscores],axis=1)\n",
    "featureScores.columns = ['Specs','Score']  #naming the dataframe columns\n",
    "print(featureScores.nlargest(11,'Score'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "id": "d3a994f5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     age  fbs  exang  slope\n",
      "173   65    0      0      0\n",
      "4     64    0      1      1\n",
      "96    59    1      0      1\n",
      "272   46    0      1      1\n",
      "61    44    0      0      0\n",
      "..   ...  ...    ...    ...\n",
      "251   53    0      0      1\n",
      "192   61    0      1      1\n",
      "117   52    1      0      0\n",
      "47    52    0      0      0\n",
      "172   65    0      0      0\n",
      "\n",
      "[172 rows x 4 columns]\n"
     ]
    }
   ],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.42, random_state = 0)\n",
    "print(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "id": "addf9736",
   "metadata": {},
   "outputs": [],
   "source": [
    "sc = StandardScaler()\n",
    "X_train = sc.fit_transform(X_train)\n",
    "X_test = sc.transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "id": "5738cd3f",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\hayde\\anaconda3\\lib\\site-packages\\sklearn\\utils\\validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n",
      "  y = column_or_1d(y, warn=True)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(random_state=0)"
      ]
     },
     "execution_count": 141,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classifier = LogisticRegression(random_state = 0)\n",
    "classifier.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "id": "39f89dbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = classifier.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "id": "e97bedf5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[50  8]\n",
      " [24 43]]\n"
     ]
    }
   ],
   "source": [
    "cm = confusion_matrix(y_test, y_pred)\n",
    "print(cm)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "id": "8303a7da",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "disp = ConfusionMatrixDisplay(confusion_matrix = cm, display_labels = classifier.classes_)\n",
    "disp.plot()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "id": "a30e0337",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.744"
      ]
     },
     "execution_count": 145,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "6674a5b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Experiment 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e58c36c7",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "id": "45bfdb6f",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = pd.get_dummies(dataset[['thal','age', 'restecg']])\n",
    "y = dataset[['condition']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "6520235f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Specs      Score\n",
      "0     thal  87.903888\n",
      "1      age  22.917697\n",
      "2  restecg   8.134652\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_selection import SelectKBest, chi2\n",
    "\n",
    "bestfeatures = SelectKBest(score_func=chi2, k=1)\n",
    "fit = bestfeatures.fit(X,y)\n",
    "\n",
    "\n",
    "dfscores = pd.DataFrame(fit.scores_)\n",
    "dfcolumns = pd.DataFrame(X.columns)\n",
    "\n",
    " \n",
    "featureScores = pd.concat([dfcolumns,dfscores],axis=1)\n",
    "featureScores.columns = ['Specs','Score']  #naming the dataframe columns\n",
    "print(featureScores.nlargest(11,'Score'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "id": "d5c9a380",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     thal  age  restecg\n",
      "210     1   59        2\n",
      "259     2   51        0\n",
      "156     0   71        0\n",
      "33      0   57        2\n",
      "83      0   65        2\n",
      "..    ...  ...      ...\n",
      "251     0   53        2\n",
      "192     2   61        0\n",
      "117     2   52        0\n",
      "47      0   52        0\n",
      "172     2   65        0\n",
      "\n",
      "[193 rows x 3 columns]\n"
     ]
    }
   ],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.35, random_state = 0)\n",
    "print(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "e805bd4e",
   "metadata": {},
   "outputs": [],
   "source": [
    "sc = StandardScaler()\n",
    "X_train = sc.fit_transform(X_train)\n",
    "X_test = sc.transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "id": "b7a1a3d7",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\hayde\\anaconda3\\lib\\site-packages\\sklearn\\utils\\validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n",
      "  y = column_or_1d(y, warn=True)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(random_state=0)"
      ]
     },
     "execution_count": 159,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classifier = LogisticRegression(random_state = 0)\n",
    "classifier.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "id": "4b8179b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = classifier.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "id": "dc1954c4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[35 11]\n",
      " [15 43]]\n"
     ]
    }
   ],
   "source": [
    "cm = confusion_matrix(y_test, y_pred)\n",
    "print(cm)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "id": "978cd274",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "disp = ConfusionMatrixDisplay(confusion_matrix = cm, display_labels = classifier.classes_)\n",
    "disp.plot()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "id": "2e1bd1a1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.75"
      ]
     },
     "execution_count": 163,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "50e85c31",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Experiment 3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "1ecdeccb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Specs      Score\n",
      "0     thal  87.903888\n",
      "1      age  22.917697\n",
      "2  restecg   8.134652\n"
     ]
    }
   ],
   "source": [
    "bestfeatures = SelectKBest(score_func=chi2, k=1)\n",
    "fit = bestfeatures.fit(X,y)\n",
    "\n",
    "\n",
    "dfscores = pd.DataFrame(fit.scores_)\n",
    "dfcolumns = pd.DataFrame(X.columns)\n",
    "\n",
    " \n",
    "featureScores = pd.concat([dfcolumns,dfscores],axis=1)\n",
    "featureScores.columns = ['Specs','Score']  #naming the dataframe columns\n",
    "print(featureScores.nlargest(11,'Score'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "0b4102b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = pd.get_dummies(dataset[['thal','exang', 'age', 'slope', 'restecg']])\n",
    "y = dataset[['condition']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "181d494e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Specs      Score\n",
      "0     thal  87.903888\n",
      "1    exang  35.508090\n",
      "2      age  22.917697\n",
      "3    slope  20.818579\n",
      "4  restecg   8.134652\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_selection import SelectKBest, chi2\n",
    "\n",
    "bestfeatures = SelectKBest(score_func=chi2, k=1)\n",
    "fit = bestfeatures.fit(X,y)\n",
    "\n",
    "\n",
    "dfscores = pd.DataFrame(fit.scores_)\n",
    "dfcolumns = pd.DataFrame(X.columns)\n",
    "\n",
    " \n",
    "featureScores = pd.concat([dfcolumns,dfscores],axis=1)\n",
    "featureScores.columns = ['Specs','Score']  #naming the dataframe columns\n",
    "print(featureScores.nlargest(11,'Score'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "7a3deab8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     thal  exang  age  slope  restecg\n",
      "210     1      0   59      1        2\n",
      "259     2      1   51      1        0\n",
      "156     0      0   71      1        0\n",
      "33      0      0   57      1        2\n",
      "83      0      0   65      0        2\n",
      "..    ...    ...  ...    ...      ...\n",
      "251     0      0   53      1        2\n",
      "192     2      1   61      1        0\n",
      "117     2      0   52      0        0\n",
      "47      0      0   52      0        0\n",
      "172     2      0   65      0        0\n",
      "\n",
      "[193 rows x 5 columns]\n"
     ]
    }
   ],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.35, random_state = 0)\n",
    "print(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "id": "426f51f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "sc = StandardScaler()\n",
    "X_train = sc.fit_transform(X_train)\n",
    "X_test = sc.transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "id": "c19c9445",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\hayde\\anaconda3\\lib\\site-packages\\sklearn\\utils\\validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n",
      "  y = column_or_1d(y, warn=True)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(random_state=0)"
      ]
     },
     "execution_count": 98,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classifier = LogisticRegression(random_state = 0)\n",
    "classifier.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "id": "653c781f",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = classifier.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "4c872f14",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[37  9]\n",
      " [10 48]]\n"
     ]
    }
   ],
   "source": [
    "cm = confusion_matrix(y_test, y_pred)\n",
    "print(cm)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "id": "8e07aea7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "disp = ConfusionMatrixDisplay(confusion_matrix = cm, display_labels = classifier.classes_)\n",
    "disp.plot()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "id": "e381e70f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8173076923076923"
      ]
     },
     "execution_count": 102,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "6f8c8445",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Experiment 4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "74d1ecda",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 297 entries, 0 to 296\n",
      "Data columns (total 14 columns):\n",
      " #   Column     Non-Null Count  Dtype  \n",
      "---  ------     --------------  -----  \n",
      " 0   age        297 non-null    int64  \n",
      " 1   sex        297 non-null    int64  \n",
      " 2   cp         297 non-null    int64  \n",
      " 3   trestbps   297 non-null    int64  \n",
      " 4   chol       297 non-null    int64  \n",
      " 5   fbs        297 non-null    int64  \n",
      " 6   restecg    297 non-null    int64  \n",
      " 7   thalach    297 non-null    int64  \n",
      " 8   exang      297 non-null    int64  \n",
      " 9   oldpeak    297 non-null    float64\n",
      " 10  slope      297 non-null    int64  \n",
      " 11  ca         297 non-null    int64  \n",
      " 12  thal       297 non-null    int64  \n",
      " 13  condition  297 non-null    int64  \n",
      "dtypes: float64(1), int64(13)\n",
      "memory usage: 32.6 KB\n"
     ]
    }
   ],
   "source": [
    "dataset.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "id": "6269a14c",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = pd.get_dummies(dataset[['thal','ca', 'slope', 'oldpeak', 'fbs']])\n",
    "y = dataset[['condition']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "id": "3e8f7e56",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Specs      Score\n",
      "0     thal  87.903888\n",
      "1       ca  82.730613\n",
      "3  oldpeak  68.570533\n",
      "2    slope  20.818579\n",
      "4      fbs   0.002547\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_selection import SelectKBest, chi2\n",
    "\n",
    "bestfeatures = SelectKBest(score_func=chi2, k=1)\n",
    "fit = bestfeatures.fit(X,y)\n",
    "\n",
    "\n",
    "dfscores = pd.DataFrame(fit.scores_)\n",
    "dfcolumns = pd.DataFrame(X.columns)\n",
    "\n",
    " \n",
    "featureScores = pd.concat([dfcolumns,dfscores],axis=1)\n",
    "featureScores.columns = ['Specs','Score']  #naming the dataframe columns\n",
    "print(featureScores.nlargest(11,'Score'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "id": "246f85af",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     thal  ca  slope  oldpeak  fbs\n",
      "291     2   0      1      2.0    0\n",
      "213     1   3      2      4.4    0\n",
      "149     0   0      0      0.0    0\n",
      "112     0   0      0      0.0    0\n",
      "287     0   0      1      0.6    0\n",
      "..    ...  ..    ...      ...  ...\n",
      "251     0   0      1      0.4    0\n",
      "192     2   1      1      3.6    0\n",
      "117     2   0      0      0.5    1\n",
      "47      0   1      0      0.8    0\n",
      "172     2   0      0      0.4    0\n",
      "\n",
      "[118 rows x 5 columns]\n"
     ]
    }
   ],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.6, random_state = 0)\n",
    "print(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 167,
   "id": "8c9ceee4",
   "metadata": {},
   "outputs": [],
   "source": [
    "sc = StandardScaler()\n",
    "X_train = sc.fit_transform(X_train)\n",
    "X_test = sc.transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 168,
   "id": "5befaf20",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\hayde\\anaconda3\\lib\\site-packages\\sklearn\\utils\\validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n",
      "  y = column_or_1d(y, warn=True)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(random_state=0)"
      ]
     },
     "execution_count": 168,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classifier = LogisticRegression(random_state = 0)\n",
    "classifier.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 169,
   "id": "6b59bd29",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = classifier.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "id": "ba8fa37b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[78 13]\n",
      " [22 66]]\n"
     ]
    }
   ],
   "source": [
    "cm = confusion_matrix(y_test, y_pred)\n",
    "print(cm)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "id": "3730a48b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "disp = ConfusionMatrixDisplay(confusion_matrix = cm, display_labels = classifier.classes_)\n",
    "disp.plot()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "id": "8a6149c6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8044692737430168"
      ]
     },
     "execution_count": 172,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "8e7cfc18",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Experiment 5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "93ba875d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 297 entries, 0 to 296\n",
      "Data columns (total 14 columns):\n",
      " #   Column     Non-Null Count  Dtype  \n",
      "---  ------     --------------  -----  \n",
      " 0   age        297 non-null    int64  \n",
      " 1   sex        297 non-null    int64  \n",
      " 2   cp         297 non-null    int64  \n",
      " 3   trestbps   297 non-null    int64  \n",
      " 4   chol       297 non-null    int64  \n",
      " 5   fbs        297 non-null    int64  \n",
      " 6   restecg    297 non-null    int64  \n",
      " 7   thalach    297 non-null    int64  \n",
      " 8   exang      297 non-null    int64  \n",
      " 9   oldpeak    297 non-null    float64\n",
      " 10  slope      297 non-null    int64  \n",
      " 11  ca         297 non-null    int64  \n",
      " 12  thal       297 non-null    int64  \n",
      " 13  condition  297 non-null    int64  \n",
      "dtypes: float64(1), int64(13)\n",
      "memory usage: 32.6 KB\n"
     ]
    }
   ],
   "source": [
    "dataset.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 173,
   "id": "bd1ef6c4",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = pd.get_dummies(dataset[['age','sex', 'cp', 'trestbps', 'chol','fbs','restecg','thalach','exang','oldpeak','slope','ca','thal']])\n",
    "y = dataset[['condition']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "id": "4bcad792",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "       Specs       Score\n",
      "7    thalach  187.053104\n",
      "12      thal   87.903888\n",
      "11        ca   82.730613\n",
      "9    oldpeak   68.570533\n",
      "8      exang   35.508090\n",
      "0        age   22.917697\n",
      "2         cp   21.352432\n",
      "4       chol   20.855084\n",
      "10     slope   20.818579\n",
      "3   trestbps   16.707463\n",
      "6    restecg    8.134652\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_selection import SelectKBest, chi2\n",
    "\n",
    "bestfeatures = SelectKBest(score_func=chi2, k=1)\n",
    "fit = bestfeatures.fit(X,y)\n",
    "\n",
    "\n",
    "dfscores = pd.DataFrame(fit.scores_)\n",
    "dfcolumns = pd.DataFrame(X.columns)\n",
    "\n",
    " \n",
    "featureScores = pd.concat([dfcolumns,dfscores],axis=1)\n",
    "featureScores.columns = ['Specs','Score']  #naming the dataframe columns\n",
    "print(featureScores.nlargest(11,'Score'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 175,
   "id": "44dcad6b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     age  sex  cp  trestbps  chol  fbs  restecg  thalach  exang  oldpeak  \\\n",
      "210   59    1   3       164   176    1        2       90      0      1.0   \n",
      "259   51    0   3       130   305    0        0      142      1      1.2   \n",
      "156   71    0   3       112   149    0        0      125      0      1.6   \n",
      "33    57    0   1       130   236    0        2      174      0      0.0   \n",
      "83    65    0   2       140   417    1        2      157      0      0.8   \n",
      "..   ...  ...  ..       ...   ...  ...      ...      ...    ...      ...   \n",
      "251   53    0   3       130   264    0        2      143      0      0.4   \n",
      "192   61    1   3       120   260    0        0      140      1      3.6   \n",
      "117   52    1   2       172   199    1        0      162      0      0.5   \n",
      "47    52    1   1       134   201    0        0      158      0      0.8   \n",
      "172   65    1   3       120   177    0        0      140      0      0.4   \n",
      "\n",
      "     slope  ca  thal  \n",
      "210      1   2     1  \n",
      "259      1   0     2  \n",
      "156      1   0     0  \n",
      "33       1   1     0  \n",
      "83       0   1     0  \n",
      "..     ...  ..   ...  \n",
      "251      1   0     0  \n",
      "192      1   1     2  \n",
      "117      0   0     2  \n",
      "47       0   1     0  \n",
      "172      0   0     2  \n",
      "\n",
      "[193 rows x 13 columns]\n"
     ]
    }
   ],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.35, random_state = 0)\n",
    "print(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "id": "7c01c710",
   "metadata": {},
   "outputs": [],
   "source": [
    "sc = StandardScaler()\n",
    "X_train = sc.fit_transform(X_train)\n",
    "X_test = sc.transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 177,
   "id": "93c7d40d",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\hayde\\anaconda3\\lib\\site-packages\\sklearn\\utils\\validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n",
      "  y = column_or_1d(y, warn=True)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(random_state=0)"
      ]
     },
     "execution_count": 177,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classifier = LogisticRegression(random_state = 0)\n",
    "classifier.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "id": "b24f83da",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = classifier.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 179,
   "id": "fd2e3f85",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[40  6]\n",
      " [ 8 50]]\n"
     ]
    }
   ],
   "source": [
    "cm = confusion_matrix(y_test, y_pred)\n",
    "print(cm)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "id": "8a7d56bf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "disp = ConfusionMatrixDisplay(confusion_matrix = cm, display_labels = classifier.classes_)\n",
    "disp.plot()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "id": "1dea5dac",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8653846153846154"
      ]
     },
     "execution_count": 181,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "f04a3c33",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Experiment 6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "3039f934",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 297 entries, 0 to 296\n",
      "Data columns (total 14 columns):\n",
      " #   Column     Non-Null Count  Dtype  \n",
      "---  ------     --------------  -----  \n",
      " 0   age        297 non-null    int64  \n",
      " 1   sex        297 non-null    int64  \n",
      " 2   cp         297 non-null    int64  \n",
      " 3   trestbps   297 non-null    int64  \n",
      " 4   chol       297 non-null    int64  \n",
      " 5   fbs        297 non-null    int64  \n",
      " 6   restecg    297 non-null    int64  \n",
      " 7   thalach    297 non-null    int64  \n",
      " 8   exang      297 non-null    int64  \n",
      " 9   oldpeak    297 non-null    float64\n",
      " 10  slope      297 non-null    int64  \n",
      " 11  ca         297 non-null    int64  \n",
      " 12  thal       297 non-null    int64  \n",
      " 13  condition  297 non-null    int64  \n",
      "dtypes: float64(1), int64(13)\n",
      "memory usage: 32.6 KB\n"
     ]
    }
   ],
   "source": [
    "dataset.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 182,
   "id": "4def6a7a",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = pd.get_dummies(dataset[['sex','exang','slope','thalach','age','cp']])\n",
    "y = dataset[['condition']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "id": "1f847207",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Specs       Score\n",
      "3  thalach  187.053104\n",
      "1    exang   35.508090\n",
      "4      age   22.917697\n",
      "5       cp   21.352432\n",
      "2    slope   20.818579\n",
      "0      sex    7.444195\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_selection import SelectKBest, chi2\n",
    "\n",
    "bestfeatures = SelectKBest(score_func=chi2, k=2)\n",
    "fit = bestfeatures.fit(X,y)\n",
    "\n",
    "\n",
    "dfscores = pd.DataFrame(fit.scores_)\n",
    "dfcolumns = pd.DataFrame(X.columns)\n",
    "\n",
    " \n",
    "featureScores = pd.concat([dfcolumns,dfscores],axis=1)\n",
    "featureScores.columns = ['Specs','Score']  #naming the dataframe columns\n",
    "print(featureScores.nlargest(11,'Score'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 184,
   "id": "5524730b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     sex  exang  slope  thalach  age  cp\n",
      "168    1      1      0      132   66   3\n",
      "175    1      0      1      132   64   3\n",
      "54     1      0      0      156   46   1\n",
      "135    0      1      2      160   46   2\n",
      "18     1      0      1      132   45   0\n",
      "..   ...    ...    ...      ...  ...  ..\n",
      "251    0      0      1      143   53   3\n",
      "192    1      1      1      140   61   3\n",
      "117    1      0      0      162   52   2\n",
      "47     1      0      0      158   52   1\n",
      "172    1      0      0      140   65   3\n",
      "\n",
      "[207 rows x 6 columns]\n"
     ]
    }
   ],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 0)\n",
    "print(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "id": "1a8dedbc",
   "metadata": {},
   "outputs": [],
   "source": [
    "sc = StandardScaler()\n",
    "X_train = sc.fit_transform(X_train)\n",
    "X_test = sc.transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "id": "a81731e0",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\hayde\\anaconda3\\lib\\site-packages\\sklearn\\utils\\validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n",
      "  y = column_or_1d(y, warn=True)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(random_state=0)"
      ]
     },
     "execution_count": 186,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classifier = LogisticRegression(random_state = 0)\n",
    "classifier.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "id": "0bfc0837",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = classifier.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "id": "b9af4a5c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[30  8]\n",
      " [10 42]]\n"
     ]
    }
   ],
   "source": [
    "cm = confusion_matrix(y_test, y_pred)\n",
    "print(cm)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 189,
   "id": "ddf9250d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "disp = ConfusionMatrixDisplay(confusion_matrix = cm, display_labels = classifier.classes_)\n",
    "disp.plot()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "id": "034388d2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8"
      ]
     },
     "execution_count": 190,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a02e8ab",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "686d6a75",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "72c6c55c",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4b2c6420",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
